<div class="sku-ovl-backdrop" *ngIf="aberto">
  <div class="sku-ovl">
    <div class="sku-ovl-header">
      <h3>SKUs do Produto <span *ngIf="referencia">— {{ referencia }}</span></h3>

      <div style="display:flex; gap:8px; align-items:center;">
        <button class="btn" type="button" (click)="recarregar()">Recarregar</button>
        <button class="btn" type="button" (click)="fechar()" aria-label="Fechar">✕</button>
      </div>
    </div>

    <div class="sku-ovl-body">
      <div *ngIf="erroMsg()" class="alert error">{{ erroMsg() }}</div>
      <div *ngIf="loading()" class="muted">Carregando...</div>

      <ng-container *ngIf="!loading()">
        <div *ngIf="(skus() ?? []).length === 0" class="muted">
          Nenhum SKU encontrado.
        </div>

        <table *ngIf="(skus() ?? []).length" class="sku-table">
          <thead>
            <tr>
              <th>EAN-13</th>
              <th>Cor</th>
              <th>Tamanho</th>
              <th>Status</th>
              <th style="width:110px;">Ação</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let r of skus()">
              <td>{{ r.ean13 }}</td>
              <td>
                <span>{{ r.cor || '—' }}</span>
                <small *ngIf="r.cor_codigo"> ({{ r.cor_codigo }})</small>
              </td>
              <td>{{ r.tamanho || '—' }}</td>
              <td>{{ r.ativo ? 'Ativo' : 'Inativo' }}</td>
              <td>
                <button
                  class="btn btn-primary"
                  type="button"
                  [disabled]="r._saving"
                  (click)="onToggleSku(r)">
                  {{ r.ativo ? 'Desativar' : 'Ativar' }}
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </ng-container>
    </div>
  </div>
</div>
